{"version":3,"file":"index.js","sources":["../src/Popover/index.tsx"],"sourcesContent":["import React from \"react\";\nimport { AbstractTooltip } from \"../AbstractTooltip\";\nimport { TippyPopoverStyles } from \"./popover/TippyPopoverStyles\";\nimport { sizeModifier } from \"./popover/sizeModifier\";\n\ninterface Props\n  extends Pick<\n    React.ComponentProps<typeof AbstractTooltip>,\n    | \"children\"\n    | \"content\"\n    | \"disabled\"\n    | \"fallbackPlacements\"\n    | \"matchTriggerWidth\"\n    | \"maxWidth\"\n    | \"onCreate\"\n    | \"placement\"\n    | \"popperOptions\"\n  > {\n  className?: string;\n  style?: React.CSSProperties;\n\n  /**\n   * Don't use `children`, use `trigger` instead\n   */\n  children?: never;\n  /**\n   * Element that will be monitored to trigger the popover\n   */\n  trigger: React.ComponentProps<typeof AbstractTooltip>[\"children\"];\n  /**\n   * Events used to know when to trigger the popover\n   *\n   * @see https://atomiks.github.io/tippyjs/v6/all-props/#trigger\n   */\n  triggerEvents?: React.ComponentProps<typeof AbstractTooltip>[\"trigger\"];\n\n  /**\n   * Interactive mode turns off hiding when clicking on descendents.\n   * Useful for nested / toggle lists etc.\n   */\n  interactive?: boolean;\n}\n\nexport const Popover: React.FC<Props> = ({\n  fallbackPlacements,\n  content,\n  popperOptions,\n  trigger,\n  triggerEvents = \"mousedown\",\n  interactive,\n  ...props\n}) => {\n  const instanceRef = React.useRef<\n    Parameters<\n      NonNullable<React.ComponentProps<typeof AbstractTooltip>[\"onCreate\"]>\n    >[0]\n  >();\n\n  /**\n   * Callback to handle descendent `ListItem` clicks.\n   *\n   * When we have nested lists and toggle lists we might need to change how this\n   * behaves.\n   */\n  const handleClick = React.useCallback<React.MouseEventHandler>(\n    (element) => {\n      if (interactive || element.target === element.currentTarget) {\n        // We're listening for clicks on descendents so ignore events that come\n        // from the element with the listener.\n        return;\n      }\n\n      // how do we know if we want to hide the list?\n      instanceRef.current?.hide();\n    },\n    [interactive]\n  );\n\n  return (\n    <>\n      <TippyPopoverStyles />\n      <AbstractTooltip\n        appendTo=\"parent\"\n        offset={[0, 2]}\n        onCreate={(instance) => {\n          instanceRef.current = instance;\n        }}\n        content={<span onClick={handleClick}>{content}</span>}\n        hideOnClick\n        theme=\"space-kit-list\"\n        trigger={triggerEvents}\n        popperOptions={{\n          strategy: \"fixed\",\n          ...popperOptions,\n          modifiers: [\n            // Disable `flip` because we're using our new version\n            { name: \"flip\", enabled: false },\n            {\n              name: \"findTippyBox\",\n              phase: \"read\",\n              enabled: true,\n              fn({ name, state }) {\n                const element = state.elements.popper.querySelector<\n                  HTMLElement\n                >(\".tippy-box\");\n\n                state.modifiersData[name].boxElement = element;\n              },\n            },\n            sizeModifier,\n            {\n              name: \"maxSize\",\n              requires: [\"findTippyBox\"],\n              options: { padding: 7, fallbackPlacements },\n            },\n            {\n              name: \"applyMaxSize\",\n              enabled: true,\n              phase: \"beforeWrite\",\n              requires: [\"maxSize\", \"findTippyBox\"],\n              fn({ state }) {\n                const maxHeight = state.modifiersData.maxSize.height;\n\n                /**\n                 * We read this element in the `findTippyBox` phase. We need to\n                 * use some custom logic here to apply the style to the tippy\n                 * box because usually that's not made available. We _could_\n                 * apply these styles directly to the `popper` element and, but\n                 * then the border will be swallowed by the overflow. If we put\n                 * the border on `popper`, then the border will not be animated\n                 * because animations are applied to `.tippy-box`.\n                 */\n                const element: HTMLElement | null =\n                  state.modifiersData.findTippyBox.boxElement;\n\n                if (element) {\n                  element.style.maxHeight = `${maxHeight}px`;\n                  element.style.overflow = \"auto\";\n                }\n              },\n            },\n            // Modifiers later in the list override modifiers earlier in the\n            // list, so we have to place this at the end so user-defined\n            // modifiers can override space kit defined modifier configurations.\n            ...(popperOptions?.modifiers || []),\n          ],\n        }}\n        {...props}\n        interactive\n      >\n        {trigger}\n      </AbstractTooltip>\n    </>\n  );\n};\n"],"names":["React","TippyPopoverStyles","AbstractTooltip","sizeModifier"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;IA2Ca,OAAO,GAAoB,UAAC,EAQxC;IAPC,IAAA,kBAAkB,wBAAA,EAClB,OAAO,aAAA,EACP,aAAa,mBAAA,EACb,OAAO,aAAA,EACP,qBAA2B,EAA3B,aAAa,mBAAG,WAAW,KAAA,EAC3B,WAAW,iBAAA,EACR,KAAK,qBAP+B,6FAQxC,CADS;IAER,IAAM,WAAW,GAAGA,cAAK,CAAC,MAAM,EAI7B,CAAC;;;;;;;IAQJ,IAAM,WAAW,GAAGA,cAAK,CAAC,WAAW,CACnC,UAAC,OAAO;;QACN,IAAI,WAAW,IAAI,OAAO,CAAC,MAAM,KAAK,OAAO,CAAC,aAAa,EAAE;;;YAG3D,OAAO;SACR;;QAGD,MAAA,WAAW,CAAC,OAAO,0CAAE,IAAI,GAAG;KAC7B,EACD,CAAC,WAAW,CAAC,CACd,CAAC;IAEF,QACEA;QACEA,6BAACC,qCAAkB,OAAG;QACtBD,6BAACE,uBAAe,oBACd,QAAQ,EAAC,QAAQ,EACjB,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,EACd,QAAQ,EAAE,UAAC,QAAQ;gBACjB,WAAW,CAAC,OAAO,GAAG,QAAQ,CAAC;aAChC,EACD,OAAO,EAAEF,uCAAM,OAAO,EAAE,WAAW,IAAG,OAAO,CAAQ,EACrD,WAAW,QACX,KAAK,EAAC,gBAAgB,EACtB,OAAO,EAAE,aAAa,EACtB,aAAa,oCACX,QAAQ,EAAE,OAAO,IACd,aAAa,KAChB,SAAS;;oBAEP,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,KAAK,EAAE;oBAChC;wBACE,IAAI,EAAE,cAAc;wBACpB,KAAK,EAAE,MAAM;wBACb,OAAO,EAAE,IAAI;wBACb,EAAE,EAAF,UAAG,EAAe;gCAAb,IAAI,UAAA,EAAE,KAAK,WAAA;4BACd,IAAM,OAAO,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,aAAa,CAEjD,YAAY,CAAC,CAAC;4BAEhB,KAAK,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC,UAAU,GAAG,OAAO,CAAC;yBAChD;qBACF;oBACDG,yBAAY;oBACZ;wBACE,IAAI,EAAE,SAAS;wBACf,QAAQ,EAAE,CAAC,cAAc,CAAC;wBAC1B,OAAO,EAAE,EAAE,OAAO,EAAE,CAAC,EAAE,kBAAkB,oBAAA,EAAE;qBAC5C;oBACD;wBACE,IAAI,EAAE,cAAc;wBACpB,OAAO,EAAE,IAAI;wBACb,KAAK,EAAE,aAAa;wBACpB,QAAQ,EAAE,CAAC,SAAS,EAAE,cAAc,CAAC;wBACrC,EAAE,EAAF,UAAG,EAAS;gCAAP,KAAK,WAAA;4BACR,IAAM,SAAS,GAAG,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,MAAM,CAAC;;;;;;;;;;4BAWrD,IAAM,OAAO,GACX,KAAK,CAAC,aAAa,CAAC,YAAY,CAAC,UAAU,CAAC;4BAE9C,IAAI,OAAO,EAAE;gCACX,OAAO,CAAC,KAAK,CAAC,SAAS,GAAM,SAAS,OAAI,CAAC;gCAC3C,OAAO,CAAC,KAAK,CAAC,QAAQ,GAAG,MAAM,CAAC;6BACjC;yBACF;qBACF;oBAIG,CAAA,aAAa,aAAb,aAAa,uBAAb,aAAa,CAAE,SAAS,KAAI,EAAE,SAGlC,KAAK,IACT,WAAW,WAEV,OAAO,CACQ,CACjB,EACH;CACH;;;;"}